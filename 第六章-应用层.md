# 第六章 应用层

* 每个应用层协议都是为解决一类问题，应用层的具体内容就是`规定应用进程在通信时所遵循的协议`
* 应用层的许多协议都是基于客户服务器方式，客户和服务器都是只通信中的两个应用进程，客户是请求方，服务器是提供方。

## 域名系统DNS

### 域名系统概述

* 许多应用层软件经常直接使用`域名系统，DNS`。但计算机的用户只是间接而不是直接使用域名系统
* 互联网采用层次结构的明命树作为主机的名字，并使用分布式的域名系统
* 名字到IP地址的解析是由若干个域名服务器程序完成的，域名服务器程序在专设的节点上运行，运行该程序的机器称为`域名服务器`

### 互联网的域名结构

- 互联网采用层次树状结构的命名方法
- 任何一个连接在互联网上的主机或路由器，都有一个唯一的层次结构的名字，即域名。
- 域名的结构由标号序列组成，各标号之间用点隔开
- 各标号分别代表不同级别的域名
- 域名只是一个逻辑概念，并不代表计算机所在的物理地点
- 变长的域名和使用有助于记忆的字符串，是为了便于人来使用，而IP地址时定长的32位二进制数字，自则是便于计算机处理
- 顶级域名：`TLD(Top Level Domain)`
  * 国家级顶级域名
  * 通用顶级域名
  * 基础结构域名

### 域名服务器

* 一个服务器所管辖的范围叫做`区`

* 各单位根据具体的情况来划分自己管辖的区，但在一个区中的所有节点必须是能够联通的

* 每一个区是设置相应的`权限域名服务器`，来保存该区中的所有主机的域名到IP地址的映射

* DNS服务器的管辖范围不是以域为单位，而是以区为单位

* 域名服务器有一下四种类型：

  * 根域名服务器

    * 根域名服务器是最高层次的域名服务器，也是最重要的域名服务器。所有的根域名服务器都知道所有的顶级域名服务器的域名和 IP 地址。
    * 不管是哪一个本地域名服务器，若要对互联网上任何一个域名进行解析，只要自己无法解析，就首先求助于根域名服务器。
    * 在互联网上共有 13 个不同 IP 地址的根域名服务器，它们的名字是用一个英文字母命名，从 a  一直到 m（前 13 个字母）。
    * 根域名服务器共有13套装置，不是13个机器

  * 顶级域名服务器

    * 顶级域名服务器（即 TLD 服务器）负责管理在该顶级域名服务器注册的所有二级域名。
    * 当收到 DNS 查询请求时，就给出相应的回答（可能是最后的结果，也可能是下一步应当找的域名服务器的 IP 地址）。 

  * 权限域名服务器、

    * 负责一个区的域名服务器。

    * 当一个权限域名服务器还不能给出最后的查询回答时，就会告诉发出查询请求的 

      DNS 客户，下一步应当找哪一个权限域名服务器

  * 本地域名服务器

    * 本地域名服务器对域名系统非常重要。
    * 当一个主机发出 DNS 查询请求时，这个查询请求报文就发送给本地域名服务器。
    * 每一个互联网服务提供者 ISP，或一个大学，甚至一个大学里的系，都可以拥有一个本地域名服务器，
    * 这种域名服务器有时也称为默认域名服务器。 

* 提高域名服务器的可靠性

  * DNS 域名服务器都把数据复制到几个域名服务器来保存，其中的一个是主域名服务器，其他的是辅助域名服务器。
  * 当主域名服务器出故障时，辅助域名服务器可以保证 DNS 的查询工作不会中断。
  * 主域名服务器定期把数据复制到辅助域名服务器中，而更改数据只能在主域名服务器中进行。这样就保证了数据的一致性。 

* 域名的解析过程

  * 主机向本地域名服务器的查询一般都是采用递归查询。如果主机所询问的本地域名服务器不知道被查询域名的 IP 地址，那么本地域名服务器就以 DNS 客户的身份，向其他根域名服务器继续发出查询请求报文。
  * 本地域名服务器向根域名服务器的查询通常是采用迭代查询。当根域名服务器收到本地域名服务器的迭代查询请求报文时，要么给出所要查询的 IP 地址，要么告诉本地域名服务器：“你下一步应当向哪一个域名服务器进行查询”。然后让本地域名服务器进行后续的查询。

* 名字的高速缓存

  * 每个域名服务器都维护一个高速缓存，存放最近用过的名字以及从何处获得名字映射信息的记录。
  * 可大大减轻根域名服务器的负荷，使互联网上的 DNS 查询请求和回答报文的数量大为减少。 
  * 为保持高速缓存中的内容正确，域名服务器应为每项内容设置计时器，并处理超过合理时间的项（例如，每个项目只存放两天）。
  * 当权限域名服务器回答一个查询请求时，在响应中都指明绑定有效存在的时间值。增加此时间值可减少网络开销，而减少此时间值可提高域名转换的准确性。 

## 文件传送协议

### FTP协议概述

* 文件传送协议 FTP (File Transfer Protocol) 是互联网上使用得最广泛的文件传送协议。
* FTP 提供交互式的访问，允许客户指明文件的类型与格式，并允许文件具有存取权限。

### FTP的基本工作原理

* 网络环境下复制文件的复杂性：

  * (1) 计算机存储数据的格式不同。
  * (2) 文件的目录结构和文件命名的规定不同。
  * (3) 对于相同的文件存取功能，操作系统使用的命令不同。
  * (4) 访问控制方法不同。 

* FTP特点：

  * 文件传送协议 FTP 只提供文件传送的一些基本的服务，它使用 TCP 可靠的运输服务。
  * FTP 的主要功能是减少或消除在不同操作系统下处理文件的不兼容性。
  * FTP 使用客户服务器方式。一个 FTP 服务器进程可同时为多个客户进程提供服务。FTP 的服务器进程由两大部分组成：一个`主进程`，负责接受新的请求；另外有若干个`从属进程`，负责处理单个请求。

* 主进程的工作步骤：

  * 打开熟知端口（端口号为 21），使客户进程能够连接上。
  * 等待客户进程发出连接请求。
  * 启动从属进程来处理客户进程发来的请求。从属进程对客户进程的请求处理完毕后即终止，但从属进程在运行期间根据需要还可能创建其他一些子进程。
  * 回到等待状态，继续接受其他客户进程发来的请求。主进程与从属进程的处理是并发地进行。 

* 两个连接：

  * TCP控制连接：

    控制连接在整个会话期间一直保持打开，FTP 客户发出的传送请求通过控制连接发送给服务器端的控制进程，但控制连接不用来传送文件。 

  * TCP数据连接：

    实际用于传输文件的是“数据连接”。服务器端的控制进程在接收到 FTP 客户发送来的文件传输请求后就创建“数据传送进程”和“数据连接”，用来连接客户端和服务器端的数据传送进程。

    数据传送进程实际完成文件的传送，在传送完毕后关闭“数据传送连接”并结束运行。 

* 两个不同的端口号

  * 当客户进程向服务器进程发出建立连接请求时，要寻找连接服务器进程的熟知端口 (21)，同时还要告诉服务器进程自己的另一个端口号码，用于建立数据传送连接。
  * 接着，服务器进程用自己传送数据的熟知端口 (20) 与客户进程所提供的端口号码建立数据传送连接。
  * 由于 FTP 使用了两个不同的端口号，所以数据连接与控制连接不会发生混乱。

* 使用两个端口号的好处

  * 使协议更加简单和更容易实现。
  * 在传输文件时还可以利用控制连接（例如，客户发送请求终止传输）。

* NFS(网络文件系统)采用的另一种思路

  * NFS 允许应用进程打开一个远地文件，并能在该文件的某一个特定的位置上开始读写数据。
  * NFS 可使用户只复制一个大文件中的一个很小的片段，而不需要复制整个大文件。

### 简单文件传送协议TFTP

* TFTP (Trivial File Transfer Protocol) 是一个很小且易于实现的文件传送协议。
* TFTP 使用客户服务器方式和使用 UDP 数据报，因此 TFTP 需要有自己的差错改正措施。
* TFTP 只支持文件传输而不支持交互。
* TFTP 没有一个庞大的命令集，没有列目录的功能，也不能对用户进行身份鉴别。
* 特点：
  * (1) 每次传送的数据 PDU 中有 512 字节的数据，但最后一次可不足 512 字节。
  * (2) 数据 PDU 也称为文件块 (block)，每个块按序编号，从 1 开始。
  * (3) 支持 ASCII 码或二进制传送。
  * (4) 可对文件进行读或写。
  * (5) 使用很简单的首部。 
* TFTP的工作很像停止等待协议
  * 发送完一个文件块后就等待对方的确认，确认时应指明所确认的块编号。
  * 发完数据后在规定时间内收不到确认就要重发数据 PDU。
  * 发送确认 PDU 的一方若在规定时间内收不到下一个文件块，也要重发确认 PDU。这样就可保证文件的传送不致因某一个数据报的丢失而告失败。 
  * 开始工作时，TFTP 客户进程发送一个读请求 PDU 或写请求 PDU 给 TFTP 服务器进程，其熟知端口号码为  69。
  * TFTP 服务器进程要选择一个新的端口和 TFTP 客户进程进行通信。
  * 若文件长度恰好为 512 字节的整数倍，则在文件传送完毕后，还必须在最后发送一个只含首部而无数据的数据 PDU。
  * 若文件长度不是 512 字节的整数倍，则最后传送数据 PDU 的数据字段一定不满 512 字节，这正好可作为文件结束的标志。

## 远程终端协议TELNET

* TELNET 是一个简单的远程终端协议，也是互联网的正式标准。
* 用户用 TELNET 就可在其所在地通过 TCP 连接注册（即登录）到远地的另一个主机上（使用主机名或 IP 地址）。
* TELNET 能将用户的击键传到远地主机，同时也能将远地主机的输出通过 TCP 连接返回到用户屏幕。这种服务是透明的，因为用户感觉到好像键盘和显示器是直接连在远地主机上。 
* 网络虚拟终端NVT格式
  * 客户软件把用户的击键和命令转换成 NVT 格式，并送交服务器。
  * 服务器软件把收到的数据和命令，从 NVT 格式转换成远地系统所需的格式。
  * 向用户返回数据时，服务器把远地系统的格式转换为 NVT 格式，本地客户再从 NVT 格式转换到本地系统所需的格式。 

## 万维网WWW

### 万维网概述

* 万维网 WWW (World Wide Web) 并非某种特殊的计算机网络。
* 万维网是一个大规模的、联机式的信息储藏所。
* 万维网用链接的方法能非常方便地从互联网上的一个站点访问另一个站点，从而主动地按需获取丰富的信息。
* 这种访问方式称为“链接”。

#### 超媒体与超文本

* 万维网是分布式超媒体 (hypermedia) 系统，它是超文本 (hypertext) 系统的扩充。
* 一个超文本由多个信息源链接成。利用一个链接可使用户找到另一个文档。这些文档可以位于世界上任何一个接在互联网上的超文本系统中。超文本是万维网的基础。
* 超媒体与超文本的区别是文档内容不同。超文本文档仅包含文本信息，而超媒体文档还包含其他表示方式的信息，如图形、图像、声音、动画，甚至活动视频图像。

#### 万维网的工作方式

* 万维网以客户-服务器方式工作。
* 浏览器就是在用户计算机上的万维网客户程序。万维网文档所驻留的计算机则运行服务器程序，因此这个计算机也称为万维网服务器。
* 客户程序向服务器程序发出请求，服务器程序向客户程序送回客户所要的万维网文档。
* 在一个客户程序主窗口上显示出的万维网文档称为页面 (page)。

#### 万维网必须解决的问题

* (1) 怎样标志分布在整个互联网上的万维网文档？ 
  * 使用统一资源定位符 URL (Uniform Resource Locator) 来标志万维网上的各种文档。
  * 使每一个文档在整个互联网的范围内具有唯一的标识符 URL。 
* (2) 用何协议实现万维网上各种超链的链接？ 
  * 在万维网客户程序与万维网服务器程序之间进行交互所使用的协议，是超文本传送协议 HTTP (HyperText Transfer Protocol)。
  * HTTP 是一个应用层协议，它使用 TCP 连接进行可靠的传送。 
* (3) 怎样使各种万维网文档都能在互联网上的各种计算机上显示出来，同时使用户清楚地知道在什么地方存在着超链？ 
  * 超文本标记语言 HTML (HyperText Markup Language) 使得万维网页面的设计者可以很方便地用一个超链从本页面的某处链接到互联网上的任何一个万维网页面，并且能够在自己的计算机屏幕上将这些页面显示出来。 
* (4) 怎样使用户能够很方便地找到所需的信息？ 
  * 为了在万维网上方便地查找信息，用户可使用各种的搜索工具（即搜索引擎）。 

### 统一资源定位符

* URL格式：
  * 资源定位符 URL 是对可以从互联网上得到的资源的位置和访问方法的一种简洁表示。
  * URL 给资源的位置提供一种抽象的识别方法，并用这种方法给资源定位。
  * 只要能够对资源定位，系统就可以对资源进行各种操作，如存取、更新、替换和查找其属性。
  * URL 相当于一个文件名在网络范围的扩展。因此 URL 是与互联网相连的机器上的任何可访问对象的一个指针。  

### 超文本传送协议HTTP

* HTTP的操作过程：
  * 为了使超文本的链接能够高效率地完成，需要用 HTTP 协议来传送一切必须的信息。
  * 从层次的角度看，HTTP 是面向事务的(transaction-oriented)应用层协议，它是万维网上能够可靠地交换文件（包括文本、声音、图像等各种多媒体文件）的重要基础。
* HTTP的主要特点：
  * HTTP 是面向事务的客户服务器协议。
  * HTTP 1.0 协议是无状态的 (stateless)。
  * HTTP 协议本身也是无连接的，虽然它使用了面向连接的 TCP 向上提供的服务。
* 持续连接
  * HTTP/1.1 协议使用持续连接 (persistent connection)。
  * 万维网服务器在发送响应后仍然在一段时间内保持这条连接，使同一个客户（浏览器）和该服务器可以继续在这条连接上传送后续的 HTTP 请求报文和响应报文。
  * 这并不局限于传送同一个页面上链接的文档，而是只要这些文档都在同一个服务器上就行。
  * 目前一些流行的浏览器（例如，IE 11.0）的默认设置就是使用 HTTP/1.1。
* 持续连接的两种工作方式：
  * 非流水线方式：客户在收到前一个响应后才能发出下一个请求。这比非持续连接的两倍 RTT 的开销节省了建立 TCP 连接所需的一个 RTT 时间。但服务器在发送完一个对象后，其 TCP 连接就处于空闲状态，浪费了服务器资源。
  * 流水线方式：客户在收到 HTTP 的响应报文之前就能够接着发送新的请求报文。一个接一个的请求报文到达服务器后，服务器就可连续发回响应报文。使用流水线方式时，客户访问所有的对象只需花费一个 RTT时间，使 TCP 连接中的空闲时间减少，提高了下载文档效率。 
* 代理服务器
  * 代理服务器 (proxy server) 又称为万维网高速缓存 (Web cache)，它代表浏览器发出 HTTP 请求。
  * 万维网高速缓存把最近的一些请求和响应暂存在本地磁盘中。
  * 当与暂时存放的请求相同的新请求到达时，万维网高速缓存就把暂存的响应发送出去，而不需要按 URL 的地址再去互联网访问该资源。 
* HTTP的报文结构
  * 请求报文
  * 响应报文

![](http://wx4.sinaimg.cn/mw690/0060lm7Tly1fson92he22j30j50aidgb.jpg)

![](http://wx2.sinaimg.cn/mw690/0060lm7Tly1fsonb1ishoj30jw0b574w.jpg)

#### 在服务器上存放用户的信息

* 万维网站点使用 Cookie 来跟踪用户。
* Cookie 表示在 HTTP 服务器和客户之间传递的状态信息。
* 使用 Cookie 的网站服务器为用户产生一个唯一的识别码。利用此识别码，网站就能够跟踪该用户在该网站的活动。  

### 万维网的文档

* 万维网的文档
  * 超文本标记语言 HTML 中的 Markup 的意思就是“设置标记”。
  * HTML 定义了许多用于排版的命令（即标签）。
  * HTML 把各种标签嵌入到万维网的页面中。这样就构成了所谓的 HTML 文档。HTML 文档是一种可以用任何文本编辑器创建的 ASCII 码文件。   
  * 仅当 HTML 文档是以 .html 或 .htm 为后缀时，浏览器才对此文档的各种标签进行解释。
  * 如 HTML 文档改换以 .txt 为其后缀，则 HTML 解释程序就不对标签进行解释，而浏览器只能看见原来的文本文件。
  * 当浏览器从服务器读取 HTML 文档后，就按照 HTML 文档中的各种标签，根据浏览器所使用的显示器的尺寸和分辨率大小，重新进行排版并恢复出所读取的页面。
* 两种不同的连接：
  * 远程连接-超链的终点是其他网点上的页面。 n超链的终点是其他网点上的页面。
  * 本地连接-超链指向本计算机中的某个文件。 
* XML：
  * XML (Extensible Markup Language)是可扩展标记语言，它和HTML很相似。
  * 但XML的设计宗旨是传输数据，而不是显示数据（HTML是为了在浏览器上显示数据）
  * XML不是要替换HTML，而是对HTML的补充
* XHTML：
  * XHTML (Extensible HTML) 是可扩展超文本标记语言，它与 HTML 4.01 几乎是相同的。
  * 但 XHTML 是更严格的 HTML 版本，也是一个 W3C 标准（2000年1月），是作为一种 XML 应用被重新定义的 HTML，并将逐渐取代 HTML。
  * 新的浏览器都支持 XHTML。
* CSS：
  * CSS (Cascading Style Sheets) 是层叠样式表，它是一种样式表语言，用于为 HTML 文档定义布局。
  * CSS 与 HTML 的区别就是：HTML 用于结构化内容，而 CSS 则用于格式化结构化的内容。
* 动态万维网文档
  * 静态文档是指该文档创作完毕后就存放在万维网服务器中，在被用户浏览的过程中，内容不会改变。 
  * 动态文档是指文档的内容是在浏览器访问万维网服务器时才由应用程序动态创建。
  * 动态文档和静态文档之间的主要差别体现在服务器一端。这主要是文档内容的生成方法不同。而从浏览器的角度看，这两种文档并没有区别
* 通用网关接口CGI
  * CGI (Common Gateway Interface) 是一种标准，它定义了动态文档应如何创建，输入数据应如何提供给应用程序，以及输出结果应如何使用。
    * 万维网服务器与 CGI 的通信遵循 CGI 标准。
    * “通用”：CGI 标准所定义的规则对其他任何语言都是通用的。
    * “网关”：CGI 程序的作用像网关。
    * “接口”：有一些已定义好的变量和调用等可供其他 CGI 程序使用。  
* CGI程序：
  * CGI 程序的正式名字是 CGI 脚本 (script)。
  * “脚本”指的是一个程序，它被另一个程序（解释程序）而不是计算机的处理机来解释或执行。
  * 脚本运行起来要比一般的编译程序要慢，因为它的每一条指令先要被另一个程序来处理（这就要一些附加的指令），而不是直接被指令处理器来处理。  
* 用java技术创建活动文档
  * 由美国 Sun 公司开发的 Java 语言是一项用于创建和运行活动文档的技术。
  * 在 Java 技术中使用 “小应用程序”(applet) 来描述活动文档程序。
  * 用户从万维网服务器下载嵌入了 Java 小应用程序的 HTML 文档后，可在浏览器的屏幕上点击某个图像，就可看到动画效果，或在下拉式菜单中点击某个项目，就可看到计算结果。
  * Java技术是活动文档技术的一部分。 

### 万维网的信息检索系统

* 全文检索搜索和分类目搜索
  * 在万维网中用来进行搜索的程序叫做搜索引擎。
  * 全文检索搜索引擎是一种纯技术型的检索工具。它的工作原理是通过搜索软件到互联网上的各网站收集信息，找到一个网站后可以从这个网站再链接到另一个网站。然后按照一定的规则建立一个很大的在线数据库供用户查询。
  * 用户在查询时只要输入关键词，就从已经建立的索引数据库上进行查询（并不是实时地在互联网上检索到的信息）。
* 分类目搜索
  * 分类目录搜索引擎并不采集网站的任何信息，而是利用各网站向搜索引擎提交的网站信息时填写的关键词和网站描述等信息，经过人工审核编辑后，如果认为符合网站登录的条件，则输入到分类目录的数据库中，供网上用户查询。
  * 分类目录搜索也叫做分类网站搜索。 
* 垂直搜索引擎
  * 垂直搜索引擎 (Vertical Search Engine) 针对某一特定领域、特定人群或某一特定需求提供搜索服务。
  * 垂直搜索也是提供关键字来进行搜索的，但被放到了一个行业知识的上下文中，返回的结果更倾向于信息、消息、条目等。 

### 博客与微博

### 社交网站

## 电子邮件

### 电子邮件

* 电子邮件 (e-mail) 是互联网上使用得最多的和最受用户欢迎的一种应用。
* 电子邮件把邮件发送到收件人使用的邮件服务器，并放在其中的收件人邮箱中，收件人可随时上网到自己使用的邮件服务器进行读取。
* 电子邮件不仅使用方便，而且还具有传递迅速和费用低廉的优点。
* 现在电子邮件不仅可传送文字信息，而且还可附上声音和图像。
* 发送邮件的协议：SMTP
* 读取邮件的协议：POP3 和 IMAP
* MIME 在其邮件首部中说明了邮件的数据类型(如文本、声音、图像、视像等)，使用 MIME 可在邮件中同时传送多种类型的数据。 
* 用户代理
  * 用户代理 UA 就是用户与电子邮件系统的接口，是电子邮件客户端软件。
  * 用户代理的功能：撰写、显示、处理和通信。
  * 邮件服务器的功能是发送和接收邮件，同时还要向发信人报告邮件传送的情况（已交付、被拒绝、丢失等）。
  * 邮件服务器按照客户-服务器方式工作。邮件服务器需要使用发送和读取两个不同的协议。

### 电子邮件传送协议SMTP

* SMTP 所规定的就是在两个相互通信的 SMTP 进程之间应如何交换信息。
* 由于 SMTP 使用客户服务器方式，因此负责发送邮件的 SMTP 进程就是 SMTP 客户，而负责接收邮件的 SMTP 进程就是 SMTP 服务器。
* SMTP 规定了 14 条命令和 21 种应答信息。每条命令用 4 个字母组成，而每一种应答信息一般只有一行信息，由一个 3 位数字的代码开始，后面附上（也可不附上）很简单的文字说明。  
* SMTP通信的三个阶段：
  1. 连接建立：连接是在发送主机的 SMTP 客户和接收主机的 SMTP 服务器之间建立的。SMTP不使用中间的邮件服务器。   
  2. 邮件传送
  3. 连接释放：邮件发送完毕后，SMTP 应释放 TCP 连接。 

### 电子邮件的信息格式

### 邮件读取协议POP3和IMAP

* 邮局协议 POP 是一个非常简单、但功能有限的邮件读取协议，现在使用的是它的第三个版本 POP3。
* POP 也使用客户-服务器的工作方式。
* 在接收邮件的用户 PC 机中必须运行 POP 客户程序，而在用户所连接的 ISP 的邮件服务器中则运行 POP 服务器程序。   
* IMAP：
  * IMAP (Internet Message Access Protocol) 也是按客户服务器方式工作，现在较新的是版本 4，即 IMAP4。
  * 用户在自己的 PC 机上就可以操纵 ISP 的邮件服务器的邮箱，就像在本地操纵一样。
  * 因此 IMAP 是一个联机协议。当用户 PC 机上的 IMAP 客户程序打开 IMAP 服务器的邮箱时，用户就可看到邮件的首部。若用户需要打开某个邮件，则该邮件才传到用户的计算机上。 

### 基于万维网的电子邮件

* 电子邮件从 A 发送到网易邮件服务器使用 HTTP 协议。
* 两个邮件服务器之间的传送使用 SMTP。
* 邮件从新浪邮件服务器传送到 B 是使用 HTTP 协议。

### 通用互联网邮件扩充MIME

SMTP缺点：

- SMTP 不能传送可执行文件或其他的二进制对象。
- SMTP 限于传送 7 位的 ASCII 码。许多其他非英语国家的文字（如中文、俄文，甚至带重音符号的法文或德文）就无法传送。
- SMTP 服务器会拒绝超过一定长度的邮件。
- 某些 SMTP 的实现并没有完全按照[RFC 821]的 SMTP 标准。  
- 通用互联网邮件扩充 MIME 并没有改动 SMTP 或取代它。
- MIME 的意图是继续使用目前的 [RFC 822] 格式，但增加了邮件主体的结构，并定义了传送非 ASCII 码的编码规则。  

## 动态主机配置协议DHCP

* 为了将软件协议做成通用的和便于移植，协议软件的编写者把协议软件参数化。这就使得在很多台计算机上使用同一个经过编译的二进制代码成为可能。
* 一台计算机和另一台计算机的区别，都可通过一些不同的参数来体现。
* 在软件协议运行之前，必须给每一个参数赋值
* 在协议软件中给这些参数赋值的动作叫做协议配置。
* 一个软件协议在使用之前必须是已正确配置的。
* 具体的配置信息有哪些则取决于协议栈。 
* 动态主机配置协议DHCP
  * 互联网广泛使用的动态主机配置协议 DHCP (Dynamic Host Configuration Protocol) 提供了即插即用连网 (plug-and-play networking) 的机制。
  * 这种机制允许一台计算机加入新的网络和获取IP 地址而不用手工参与。
* DHCP中继代理
  * 并不是每个网络上都有 DHCP 服务器，这样会使 DHCP 服务器的数量太多。现在是每一个网络至少有一个 DHCP 中继代理，它配置了 DHCP 服务器的 IP 地址信息。
  * 当 DHCP 中继代理收到主机发送的发现报文后，就以单播方式向 DHCP 服务器转发此报文，并等待其回答。收到 DHCP 服务器回答的提供报文后，DHCP 中继代理再将此提供报文发回给主机。

## 简单网络管理协议SNMP

### 网络管理的基本概念

* 网络管理包括对硬件、软件和人力的使用、综合与协调，以便对网络资源进行监视、测试、配置、分析、评价和控制，这样就能以合理的价格满足网络的一些需求，如实时运行性能，服务质量等。网络管理常简称为网管。
* 网络管理并不是指对网络进行行政上的管理。
* 网络管理协议：
  * 网络管理协议简称为网管协议。
  * 需要注意的是，并不是网管协议本身来管理网络。网管协议是管理程序和代理程序之间进行通信的规则。
  * 网络管理员利用网管协议通过管理站对网络中的被管设备进行管理。 
* SNMP网络管理组成：
  * SNMP 本身
  * 管理信息结构 SMI (Structure of Management Information)
  * 管理信息库 MIB (Management Information Base)。 

### 管理信息结构SMI

* SMI 的功能：

​    (1) 被管对象应怎样命名；

​    (2) 用来存储被管对象的数据类型有哪些种；

​    (3) 在网络上传送的管理数据应如何编码。 

### 管理信息库MIB

* 被管对象必须维持可供管理程序读写的若干控制和状态信息。这些信息总称为管理信息库  MIB (Management Information Base) 。
* 管理程序使用 MIB 中这些信息的值对网络进行管理（如读取或重新设置这些值）。

### SNMP的协议数据单元和报文

* SNMP 的操作只有两种基本的管理功能：
* “读”操作，用 get 报文来检测各被管对象的状况；
* “写”操作，用 set 报文来改变各被管对象的状况。
* SNMP 的这些功能通过探询操作来实现。
* SNMP 使用无连接的 UDP，因此在网络上传送 SNMP 报文的开销较小。但 UDP 不保证可靠交付。
* 在运行代理程序的服务器端用熟知端口 161 来接收 get 或 set 报文和发送响应报文（与熟知端口通信的客户端使用临时端口）。
* 运行管理程序的客户端则使用熟知端口 162 来接收来自各代理的 trap 报文。 

## 应用进程跨越网络的通信

### 系统调用和应用编程接口

### 几种常用的系统协议

## P2P应用

- 自从互联网能够提供音频/视频服务后，宽带上网用户数也急剧增长。很多用户使用宽带接入的目的就是为了更快地下载音频/视频文件。
- P2P 工作方式受到广大网民的欢迎。这种工作方式解决了集中式媒体服务器可能出现的瓶颈问题。
- 在 P2P 工作方式下，所有的音频/视频文件都是在普通的互联网用户之间传输。这是相当于有很多分散在各地的媒体服务器向其他用户提供所要下载的音频/视频文件。
- 在互联网流量中，P2P工作方式下的文件分发已占据了最大的份额，比万维网应用所占的比例大得多。

### 具有集中目录服务器的P2P工作方式

* 最早出现的 P2P 技术，可提供免费下载 MP3 音乐。
* Napster 能够搜索音乐文件，能够提供检索功能。所有的音乐文件地址集中存放在一个 Napster 目录服务器中。使用者可很方便地下载需要的 MP3 文件。
* 用户要及时向 Napster 的目录服务器报告自己存有的音乐文件。当用户想下载某个 MP3 文件时，就向目录服务器发出询问。目录服务器检索出结果后向用户返回存放此文件的 PC 机的 IP 地址。Napster 的文件传输是分散的，但文件的定位则是集中的。
* `这种集中式目录服务器的缺点就是可靠性差`。Napster 被判决属于“间接侵害版权”，因此在 2000 年 7 月底 Napster 网站就被迫关闭了。 

### 具有全分布式结构的P2P文件共享程序

* Gnutella 是第二代 P2P 文件共享程序，采用全分布方法定位内容的P2P 文件共享应用程序。 
* Gnutella 与 Napster 最大的区别就是不使用集中式的目录服务器，而是使用洪泛法在大量 Gnutella 用户之间进行查询。
* 为了不使查询的通信量过大，Gnutella 设计了一种有限范围的洪泛查询。这样可以减少倾注到互联网的查询流量，但由于查询的范围受限，因而这也影响到查询定位的准确性。 

### P2P文件分发的分析

### 在P2P对等方中搜索对象



